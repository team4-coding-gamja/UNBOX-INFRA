# ArgoCD ê´€ë ¨ ì•Œë¦¼ ê·œì¹™
apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-alerts
  namespace: unbox-monitoring
  labels:
    grafana_alert: "1"
data:
  argocd-alerts.yaml: |
    groups:
      - name: argocd
        interval: 30s
        rules:
          # ArgoCD Sync ì‹¤íŒ¨
          - alert: ArgoCD_Sync_Failed
            expr: |
              argocd_app_sync_total{phase="Failed"} > 0
            for: 1m
            labels:
              severity: cd
              component: argocd
            annotations:
              summary: "ArgoCD Sync ì‹¤íŒ¨"
              description: "ì• í”Œë¦¬ì¼€ì´ì…˜ {{ $labels.name }}ì˜ Syncê°€ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."
          
          # ArgoCD ì• í”Œë¦¬ì¼€ì´ì…˜ Degraded ìƒíƒœ
          - alert: ArgoCD_App_Degraded
            expr: |
              argocd_app_health_status{health_status="Degraded"} > 0
            for: 5m
            labels:
              severity: warning
              component: argocd
            annotations:
              summary: "ArgoCD ì• í”Œë¦¬ì¼€ì´ì…˜ Degraded"
              description: "ì• í”Œë¦¬ì¼€ì´ì…˜ {{ $labels.name }}ì´ Degraded ìƒíƒœì…ë‹ˆë‹¤."
          
          # ArgoCD ì• í”Œë¦¬ì¼€ì´ì…˜ OutOfSync
          - alert: ArgoCD_App_OutOfSync
            expr: |
              argocd_app_sync_status{sync_status="OutOfSync"} > 0
            for: 10m
            labels:
              severity: warning
              component: argocd
            annotations:
              summary: "ArgoCD ì• í”Œë¦¬ì¼€ì´ì…˜ OutOfSync"
              description: "ì• í”Œë¦¬ì¼€ì´ì…˜ {{ $labels.name }}ì´ 10ë¶„ ì´ìƒ OutOfSync ìƒíƒœì…ë‹ˆë‹¤."
          
          # ArgoCD Sync ì‹œì‘ (ì •ë³´ì„± ì•Œë¦¼)
          - alert: ArgoCD_Sync_Started
            expr: |
              increase(argocd_app_sync_total{phase="Running"}[1m]) > 0
            labels:
              severity: cd
              component: argocd
            annotations:
              summary: "ğŸš€ ArgoCD Sync ì‹œì‘"
              description: "ì• í”Œë¦¬ì¼€ì´ì…˜ {{ $labels.name }}ì˜ ë°°í¬ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."
          
          # ArgoCD Sync ì„±ê³µ (ì •ë³´ì„± ì•Œë¦¼)
          - alert: ArgoCD_Sync_Succeeded
            expr: |
              increase(argocd_app_sync_total{phase="Succeeded"}[1m]) > 0
            labels:
              severity: cd
              component: argocd
            annotations:
              summary: "âœ… ArgoCD Sync ì™„ë£Œ"
              description: "ì• í”Œë¦¬ì¼€ì´ì…˜ {{ $labels.name }}ì˜ ë°°í¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
