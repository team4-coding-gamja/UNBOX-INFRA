# User Service - 공통 기본값
appName: user-service
replicaCount: 1
contextPath: /user

image:
  repository: ""  # 환경별로 오버라이드
  tag: latest
  pullPolicy: Always

# Ingress 설정
ingress:
  enabled: false
  path: /user
  groupName: unbox-dev
  certificateArn: ""  # 환경별로 오버라이드
  securityGroup: "unbox-dev-alb-sg"

linkerd:
  enabled: false

service:
  port: 80
  targetPort: 8081

containerPort: 8081

# 공통 환경변수 (환경별로 오버라이드)
env:
  SERVER_PORT: "8081"
  SERVER_SERVLET_CONTEXT_PATH: "/user"
  DB_DRIVER_CLASS_NAME: "org.postgresql.Driver"
  SPRING_JPA_HIBERNATE_DDL_AUTO: "update"
  SPRING_JPA_SHOW_SQL: "false"
  SPRING_DATA_REDIS_PORT: "6379"
  SPRING_DATA_REDIS_SSL: "true"
  # 메일 설정 (Gmail SMTP)
  SPRING_MAIL_HOST: "smtp.gmail.com"
  SPRING_MAIL_PORT: "587"
  SPRING_MAIL_USERNAME: "jjangjoon76@gmail.com"
  SPRING_MAIL_PASSWORD: "ohvxmekovppxinwx"
  SPRING_MAIL_PROPERTIES_MAIL_SMTP_AUTH: "true"
  SPRING_MAIL_PROPERTIES_MAIL_SMTP_STARTTLS_ENABLE: "true"
  SPRING_MAIL_PROPERTIES_MAIL_SMTP_STARTTLS_REQUIRED: "true"
  SPRING_MAIL_PROPERTIES_MAIL_SMTP_CONNECTIONTIMEOUT: "5000"
  SPRING_MAIL_PROPERTIES_MAIL_SMTP_TIMEOUT: "5000"
  SPRING_MAIL_PROPERTIES_MAIL_SMTP_WRITETIMEOUT: "5000"
  TEMPO_OTLP_ENDPOINT: "http://tempo.monitoring.svc.cluster.local:4318/v1/traces"
  USER_SERVICE_URL: "http://user-service.unbox-app"
  PRODUCT_SERVICE_URL: "http://product-service.unbox-app"
  ORDER_SERVICE_URL: "http://order-service.unbox-app"
  PAYMENT_SERVICE_URL: "http://payment-service.unbox-app"
  TRADE_SERVICE_URL: "http://trade-service.unbox-app"
# 리소스 제한 (기본값)
resources:
  requests:
    memory: "512Mi"
    cpu: "100m"
  limits:
    memory: "1Gi"

# Argo Rollouts 설정
rollout:
  enabled: false  # 환경별로 활성화
  strategy: "blueGreen"
  
  healthCheck:
    enabled: true
    path: "/user/actuator/health"
    initialDelaySeconds: 30
    periodSeconds: 10
  
  blueGreen:
    autoPromotionEnabled: false
    autoPromotionSeconds: 600
    scaleDownDelaySeconds: 300
  
  # Feature Flag 설정
  featureFlag:
    enabled: false  # User는 Feature Flag 사용 안 함
